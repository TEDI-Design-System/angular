<input
  type="text"
  [(ngModel)]="inputValue"
  class="tedi-search__input"
  cdkOverlayOrigin
  #trigger="cdkOverlayOrigin"
/>

<div class="tedi-search__suffix">
  @if (clearable() && inputValue()) {
    <tedi-icon name="close" [size]="iconSize()" />
    <div class="separator"></div>
  }
  @if (!withButton()) {
    <tedi-icon name="search" color="secondary" [size]="iconSize()" />
  }
</div>

@if (withButton()) {
  <button tedi-button class="tedi-search__trigger" [size]="buttonSize()">
    <tedi-icon name="search" color="white" [size]="buttonText() ? 18 : 24" />
    {{ buttonText() }}
  </button>
}

<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="trigger"
  [cdkConnectedOverlayHasBackdrop]="true"
  [cdkConnectedOverlayBackdropClass]="'cdk-overlay-transparent-backdrop'"
  [cdkConnectedOverlayOpen]="isOpen()"
  (detach)="isOpen.set(false)"
  (backdropClick)="isOpen.set(false)"
>
  <tedi-card class="tedi-search__panel" [style.width.px]="width()" cdkMenu>
    <tedi-card-content>
      @for (option of foundOptions(); track option.value) {
        <button
          class="tedi-search__option"
          tedi-dropdown-item
          cdkMenuItem
          [value]="option.value"
          (click)="selectResult(option)"
        >
          {{ option.label }} x {{ option.description }}
        </button>
      } @empty {
        <!-- TODO -->
        <span>Empty message</span>
      }

      <div class="tedi-search__separator"></div>
      <ng-content></ng-content>
    </tedi-card-content>
  </tedi-card>
</ng-template>
